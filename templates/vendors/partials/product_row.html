{% with stock=product.current_stock|default_if_none:0 %}
<tr id="product-row-{{ product.id }}">
  <td>
    <div class="py-1">
      <div class="d-flex flex-column justify-content-center">
        <h6 class="mb-0">{{ product.name }}</h6>
      </div>
    </div>
  </td>
  <td class="align-middle text-center">
    <span>{{ product.category }}</span>
  </td>
  <td class="align-middle text-center">
    <span class="{% if stock <= product.reorder_level and stock > 0 %}text-danger{% endif %}">{{ stock }}</span>
  </td>
  <td class="align-middle text-center">
    <span>${{ product.price }}</span>
  </td>
  <td class="align-middle text-center">
    {% if stock <= 0 %}
      <span class="badge badge-sm bg-gradient-danger">Out of Stock</span>
    {% elif stock <= product.reorder_level %}
      <span class="badge badge-sm bg-gradient-warning">Low Stock</span>
    {% else %}
      <span class="badge badge-sm bg-gradient-success">In Stock</span>
    {% endif %}
  </td>
  <td class="align-middle text-center">
    <a
      href="javascript:;"
      class="text-secondary js-view-product"
      data-name="{{ product.name|escape }}"
      data-vin="{{ product.vin|escape }}"
      data-category-label="{{ product.category|escape }}"
      data-price="{{ product.price }}"
      data-current-stock="{{ product.current_stock|default_if_none:product.initial_stock }}"
      data-reorder-level="{{ product.reorder_level }}"
      data-description="{{ product.description|escape }}"
      data-image-url="{% if product.product_image %}{{ product.product_image.url }}{% endif %}"
    >
      <i class="fas fa-eye me-2"></i>
    </a>
    <a
      href="javascript:;"
      class="text-info js-edit-product"
      data-product-id="{{ product.id }}"
      data-update-url="{% url 'vendor_product_update' product.id %}"
      data-name="{{ product.name|escape }}"
      data-vin="{{ product.vin|escape }}"
      data-category="{{ product.category }}"
      data-price="{{ product.price }}"
      data-current-stock="{{ product.current_stock|default_if_none:product.initial_stock }}"
      data-reorder-level="{{ product.reorder_level }}"
      data-description="{{ product.description|escape }}"
    >
      <i class="fas fa-edit me-2"></i>
    </a>
    <a
      href="javascript:;"
      class="text-danger js-delete-product"
      data-product-id="{{ product.id }}"
      data-product-name="{{ product.name|escape }}"
      data-delete-url="{% url 'vendor_product_delete' product.id %}"
    >
      <i class="fas fa-trash me-2"></i>
    </a>
  </td>
</tr>
{% endwith %}
